<!DOCTYPE html>
<html lang="th">
<head>
 <base target="_top">
 <meta charset="UTF-8" />
 <meta name="viewport" content="width=device-width, initial-scale=1" />
 <title>‡∏ö‡πâ‡∏≤‡∏ô‡∏û‡∏±‡∏Å‡∏Ñ‡∏£‡∏π ‡∏Ñ‡∏≤‡πÄ‡∏ü‡πà üßÅ‚òïÔ∏è</title>
 <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
 <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
 <style>
   @import url('https://fonts.googleapis.com/css2?family=Sarabun:wght@300;500;700&display=swap');
  
   body {
     font-family: 'Sarabun', sans-serif;
     background: linear-gradient(to bottom, #fff8f0, #ffeedd);
     color: #4e342e;
     padding: 20px;
   }
  
   .card {
     border: none;
     box-shadow: 0 8px 20px rgba(0, 0, 0, 0.06);
     border-radius: 1rem;
   }
  
   .card-header {
     background: linear-gradient(90deg, #d7ccc8, #f5f5f5);
     color: #3e2723;
     font-weight: 600;
   }
  
   .menu-item {
     background: #fff;
     border: 1px solid #f0e0d6;
     margin-bottom: 5px;
     border-radius: 0.75rem;
     padding: 10px 15px;
     cursor: pointer;
     transition: all 0.2s ease;
   }
  
   .menu-item:hover {
     background: #fff3e0;
     transform: scale(1.02);
   }
  
   .table thead {
     background: #bcaaa4;
     color: white;
   }
  
   .table-status {
     width: 100px;
   }
  
   .table-number {
     width: 80px;
   }
  
   .table-capacity {
     width: 100px;
   }
  
   #statusMsg {
     transition: all 0.3s ease;
   }
 </style>
</head>
<body>
 <div class="container-fluid">
   <div class="row mb-4">
     <div class="col-12">
       <h2 class="text-center">‡∏ö‡πâ‡∏≤‡∏ô‡∏û‡∏±‡∏Å‡∏Ñ‡∏£‡∏π ‡∏Ñ‡∏≤‡πÄ‡∏ü‡πà üßÅ‚òïÔ∏è</h2>
       <div class="text-center text-muted" id="current-time"></div>
     </div>
   </div>


   <!-- ‡∏™‡πà‡∏ß‡∏ô‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÇ‡∏ï‡πä‡∏∞ -->
   <div class="row mb-4">
     <div class="col-md-12">
       <div class="card">
         <div class="card-header bg-info text-white d-flex justify-content-between align-items-center">
           <h4 class="mb-0">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÇ‡∏ï‡πä‡∏∞</h4>
           <button class="btn btn-sm btn-light" onclick="loadTables()">
             <i class="bi bi-arrow-clockwise"></i> ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä
           </button>
         </div>
         <div class="card-body">
           <div class="table-responsive">
             <table class="table table-bordered table-striped" id="tableList">
               <thead>
                 <tr>
                   <th class="table-number">‡πÄ‡∏•‡∏Ç‡πÇ‡∏ï‡πä‡∏∞</th>
                   <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                   <th class="table-capacity">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏∏</th>
                   <th class="table-status">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</th>
                   <th>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                 </tr>
               </thead>
               <tbody id="tableBody">
                 <tr>
                   <td colspan="5" class="text-center py-3">
                     <div class="spinner-border text-primary" role="status">
                       <span class="visually-hidden">Loading...</span>
                     </div>
                     <p class="mt-2 mb-0">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÇ‡∏ï‡πä‡∏∞...</p>
                   </td>
                 </tr>
               </tbody>
             </table>
           </div>
         </div>
       </div>
     </div>
   </div>


   <div class="row">
     <div class="col-md-5">
       <div class="card mb-3">
         <div class="card-header bg-primary text-white">
           <h4 class="mb-0">‡πÄ‡∏°‡∏ô‡∏π</h4>
         </div>
         <div class="card-body">
           <div id="categoryFilter">
             <button class="btn btn-sm btn-outline-primary category-btn active" data-category="all">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
             <button class="btn btn-sm btn-outline-primary category-btn" data-category="drink">‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏°</button>
             <button class="btn btn-sm btn-outline-primary category-btn" data-category="food">‡∏≠‡∏≤‡∏´‡∏≤‡∏£</button>
             <button class="btn btn-sm btn-outline-primary category-btn" data-category="dessert">‡∏Ç‡∏≠‡∏á‡∏´‡∏ß‡∏≤‡∏ô</button>
           </div>
           <div id="menuList" class="list-group mt-3"></div>
         </div>
       </div>
     </div>


     <div class="col-md-7">
       <div class="card">
         <div class="card-header bg-success text-white">
           <h4 class="mb-0">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ (‡πÇ‡∏ï‡πä‡∏∞: <span id="selectedTable">-</span>)</h4>
         </div>
         <div class="card-body">
           <div class="table-responsive">
             <table class="table table-bordered table-striped" id="orderTable">
               <thead>
                 <tr>
                   <th>‡πÄ‡∏°‡∏ô‡∏π</th>
                   <th>‡∏£‡∏≤‡∏Ñ‡∏≤</th>
                   <th>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</th>
                   <th>‡∏£‡∏ß‡∏°</th>
                   <th>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                 </tr>
               </thead>
               <tbody></tbody>
               <tfoot>
                 <tr>
                   <th colspan="3" class="text-end">‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</th>
                   <th id="totalAmount">0</th>
                   <th></th>
                 </tr>
               </tfoot>
             </table>
           </div>


           <div class="mt-3 d-flex justify-content-between">
             <button class="btn btn-danger" id="clearOrderBtn" disabled>
               <i class="bi bi-trash"></i> ‡∏•‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£
             </button>
             <button class="btn btn-primary" id="sendOrderBtn" disabled>
               <i class="bi bi-send-check"></i> ‡∏™‡πà‡∏á‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå
             </button>
           </div>
           <div id="statusMsg" class="mt-3 alert" style="display:none;"></div>
         </div>
       </div>
     </div>
   </div>
 </div>


 <!-- Modal ‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÇ‡∏ï‡πä‡∏∞ -->
 <div class="modal fade" id="tableModal" tabindex="-1">
   <div class="modal-dialog">
     <div class="modal-content">
       <div class="modal-header">
         <h5 class="modal-title">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÇ‡∏ï‡πä‡∏∞ <span id="modalTableNumber"></span></h5>
         <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
       </div>
       <div class="modal-body" id="tableDetails">
         <p>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</p>
       </div>
       <div class="modal-footer">
         <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">‡∏õ‡∏¥‡∏î</button>
       </div>
     </div>
   </div>
 </div>


 <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
 <script>
   // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏°‡∏ô‡∏π
   const menuItems = [
     {id:1,name:"‡∏Å‡∏≤‡πÅ‡∏ü‡∏•‡∏≤‡πÄ‡∏ï‡πâ",price:40,category:"drink",icon:"‚òïÔ∏è"},
     {id:2,name:"‡∏ä‡∏≤‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß",price:35,category:"drink",icon:"üçµ"},
     {id:3,name:"‡πÄ‡∏Ñ‡πâ‡∏Å‡∏ä‡πá‡∏≠‡∏Å‡πÇ‡∏Å‡πÅ‡∏•‡∏ï",price:55,category:"dessert",icon:"üßÅ"},
     {id:4,name:"‡∏ô‡πâ‡∏≥‡∏™‡πâ‡∏°‡∏Ñ‡∏±‡πâ‡∏ô",price:30,category:"drink",icon:"ü•§"},
     {id:5,name:"‡πÅ‡∏ã‡∏ô‡∏ß‡∏¥‡∏ä",price:45,category:"food",icon:"ü•™"},
     {id:6,name:"‡∏ö‡∏£‡∏≤‡∏ß‡∏ô‡∏µ‡πà",price:50,category:"dessert",icon:"üç´"},
     {id:7,name:"‡∏ä‡∏≤‡πÑ‡∏ó‡∏¢",price:35,category:"drink",icon:"üßã"},
     {id:8,name:"‡∏Ñ‡∏£‡∏±‡∏ß‡∏ã‡∏≠‡∏á‡∏ï‡πå",price:40,category:"food",icon:"ü•ê"}
   ];
  
   // ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏£‡∏∞‡∏ö‡∏ö
   let selectedTable = null;
   let orders = [];
   let currentCategory = 'all';
   let tablesData = [];
  
   // DOM Elements
   const menuListEl = document.getElementById('menuList');
   const orderTableBody = document.querySelector('#orderTable tbody');
   const totalAmountEl = document.getElementById('totalAmount');
   const statusMsg = document.getElementById('statusMsg');
   const sendOrderBtn = document.getElementById('sendOrderBtn');
   const clearOrderBtn = document.getElementById('clearOrderBtn');
   const categoryBtns = document.querySelectorAll('.category-btn');
   const currentTimeEl = document.getElementById('current-time');
   const tableBodyEl = document.getElementById('tableBody');
   const selectedTableEl = document.getElementById('selectedTable');
   const tableModal = new bootstrap.Modal(document.getElementById('tableModal'));


   // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÇ‡∏ï‡πä‡∏∞
   function loadTables() {
     tableBodyEl.innerHTML = `
       <tr>
         <td colspan="5" class="text-center py-3">
           <div class="spinner-border text-primary" role="status">
             <span class="visually-hidden">Loading...</span>
           </div>
           <p class="mt-2 mb-0">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÇ‡∏ï‡πä‡∏∞...</p>
         </td>
       </tr>
     `;
    
     google.script.run
       .withSuccessHandler(tables => {
         tablesData = tables;
         renderTables();
       })
       .withFailureHandler(error => {
         console.error('Error loading tables:', error);
         showStatus('‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÇ‡∏ï‡πä‡∏∞‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', 'danger');
         // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß
         tablesData = Array.from({length: 10}, (_, i) => ({
           number: i+1,
           status: i < 7 ? '‡∏ß‡πà‡∏≤‡∏á' : '‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏á',
           capacity: 4
         }));
         renderTables();
       })
       .getAvailableTables();
   }


   // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÇ‡∏ï‡πä‡∏∞
   function renderTables() {
     if (tablesData.length === 0) {
       tableBodyEl.innerHTML = `
         <tr>
           <td colspan="5" class="text-center text-muted py-3">
             ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÇ‡∏ï‡πä‡∏∞ <button class="btn btn-sm btn-outline-primary ms-2" onclick="loadTables()">‡∏•‡∏≠‡∏á‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á</button>
           </td>
         </tr>
       `;
       return;
     }
    
     tableBodyEl.innerHTML = tablesData.map(table => `
       <tr>
         <td>${table.number}</td>
         <td>
           <span class="badge ${table.status === '‡∏ß‡πà‡∏≤‡∏á' ? 'bg-success' : 'bg-danger'}">
             ${table.status}
           </span>
         </td>
         <td>${table.capacity} ‡∏Ñ‡∏ô</td>
         <td>
           <button class="btn btn-sm ${selectedTable === table.number ? 'btn-primary' : 'btn-outline-primary'}"
             onclick="selectTable(${table.number})"
             ${table.status !== '‡∏ß‡πà‡∏≤‡∏á' && selectedTable !== table.number ? 'disabled' : ''}>
             ${selectedTable === table.number ? '‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß' : '‡πÄ‡∏•‡∏∑‡∏≠‡∏Å'}
           </button>
         </td>
         <td>
           <button class="btn btn-sm btn-outline-secondary" onclick="showTableDetails(${table.number})">
             <i class="bi bi-info-circle"></i>
           </button>
         </td>
       </tr>
     `).join('');
   }


   // ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÇ‡∏ï‡πä‡∏∞
   window.selectTable = function(tableNumber) {
     if (selectedTable === tableNumber) {
       // ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÇ‡∏ï‡πä‡∏∞‡πÄ‡∏î‡∏¥‡∏°
       selectedTable = null;
       selectedTableEl.textContent = '-';
       sendOrderBtn.disabled = true;
     } else {
       // ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÇ‡∏ï‡πä‡∏∞‡πÉ‡∏´‡∏°‡πà
       const table = tablesData.find(t => t.number === tableNumber);
      
       if (table && table.status !== '‡∏ß‡πà‡∏≤‡∏á') {
         showStatus(`‡πÇ‡∏ï‡πä‡∏∞ ${tableNumber} ‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏á‡πÉ‡∏ô‡∏Ç‡∏ì‡∏∞‡∏ô‡∏µ‡πâ`, 'warning');
         return;
       }
      
       selectedTable = tableNumber;
       selectedTableEl.textContent = tableNumber;
       sendOrderBtn.disabled = false;
     }
    
     renderTables();
     updateOrderButtons();
   }


   // ‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÇ‡∏ï‡πä‡∏∞
   window.showTableDetails = function(tableNumber) {
     document.getElementById('modalTableNumber').textContent = tableNumber;
    
     google.script.run
       .withSuccessHandler(orders => {
         let content = `<p><strong>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:</strong> ${tablesData.find(t => t.number === tableNumber).status}</p>`;
        
         if (orders.length > 0) {
           content += `<h6>‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå</h6><ul class="list-group">`;
           orders.forEach(order => {
             content += `<li class="list-group-item">${order.‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà} ${order.‡πÄ‡∏ß‡∏•‡∏≤} - ${order['‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏°‡∏ô‡∏π']} x${order.‡∏à‡∏≥‡∏ô‡∏ß‡∏ô}</li>`;
           });
           content += `</ul>`;
         } else {
           content += `<p class="text-muted">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå</p>`;
         }
        
         document.getElementById('tableDetails').innerHTML = content;
       })
       .withFailureHandler(error => {
         document.getElementById('tableDetails').innerHTML =
           `<p class="text-danger">‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•: ${error.message}</p>`;
       })
       .getOrderHistory(tableNumber);
    
     tableModal.show();
   }


   // ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏°‡∏ô‡∏π
   function renderMenu() {
     let filtered = currentCategory === 'all' ? menuItems : menuItems.filter(i => i.category === currentCategory);
     menuListEl.innerHTML = filtered.length ? filtered.map(item => `
       <div class="menu-item" onclick="addOrder(${item.id})">
         <div class="d-flex align-items-center">
           <div class="fs-3 me-2">${item.icon}</div>
           <div><strong>${item.name}</strong><br><small class="text-muted">${item.price} ‡∏ö‡∏≤‡∏ó</small></div>
         </div>
       </div>
     `).join('') : `<div class="text-muted text-center py-3">‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏°‡∏ô‡∏π‡πÉ‡∏ô‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏ô‡∏µ‡πâ</div>`;
   }


   // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå
   window.addOrder = function(id) {
     if (!selectedTable) {
       showStatus("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÇ‡∏ï‡πä‡∏∞‡∏Å‡πà‡∏≠‡∏ô", "danger");
       return;
     }
    
     const item = menuItems.find(i => i.id === id);
     const ex = orders.find(o => o.id === id);
    
     if (ex) ex.qty++;
     else orders.push({...item, qty: 1});
    
     renderOrders();
     showStatus(`‡πÄ‡∏û‡∏¥‡πà‡∏° ${item.name} ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢`, 'success');
     updateOrderButtons();
   }


   // ‡∏•‡∏ö‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå
   function removeOrder(id) {
     const idx = orders.findIndex(o => o.id === id);
     if (idx > -1) {
       const n = orders[idx].name;
       orders.splice(idx, 1);
       renderOrders();
       showStatus(`‡∏•‡∏ö ${n} ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢`, 'success');
       updateOrderButtons();
     }
   }


   // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏à‡∏≥‡∏ô‡∏ß‡∏ô
   function changeQty(id, delta) {
     const o = orders.find(x => x.id === id);
     if (!o) return;
     o.qty += delta;
     if (o.qty < 1) o.qty = 1;
     renderOrders();
     updateOrderButtons();
   }


   // ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
   function showStatus(msg, type) {
     statusMsg.textContent = msg;
     statusMsg.className = `alert alert-${type}`;
     statusMsg.style.display = 'block';
     setTimeout(() => statusMsg.style.display = 'none', 3000);
   }


   // ‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå
   function renderOrders() {
     orderTableBody.innerHTML = '';
     let total = 0;
    
     orders.forEach(o => {
       const sub = o.price * o.qty;
       total += sub;
      
       orderTableBody.insertAdjacentHTML('beforeend', `
         <tr>
           <td>${o.icon} ${o.name}</td>
           <td>${o.price} ‡∏ö‡∏≤‡∏ó</td>
           <td>
             <div class="d-flex align-items-center">
               <button class="btn btn-sm btn-danger me-2" onclick="changeQty(${o.id}, -1)">
                 <i class="bi bi-dash"></i>
               </button>
               <span class="mx-2">${o.qty}</span>
               <button class="btn btn-sm btn-success ms-2" onclick="changeQty(${o.id}, 1)">
                 <i class="bi bi-plus"></i>
               </button>
             </div>
           </td>
           <td>${sub} ‡∏ö‡∏≤‡∏ó</td>
           <td>
             <button class="btn btn-sm btn-outline-danger" onclick="removeOrder(${o.id})">
               <i class="bi bi-trash"></i>
             </button>
           </td>
         </tr>
       `);
     });
    
     totalAmountEl.textContent = total + ' ‡∏ö‡∏≤‡∏ó';
   }


   // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏õ‡∏∏‡πà‡∏°
   function updateOrderButtons() {
     clearOrderBtn.disabled = orders.length === 0;
     sendOrderBtn.disabled = orders.length === 0 || !selectedTable;
   }


   // ‡∏™‡πà‡∏á‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå
   function sendOrder() {
     if (!selectedTable) {
       showStatus("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÇ‡∏ï‡πä‡∏∞‡∏Å‡πà‡∏≠‡∏ô", "danger");
       return;
     }
    
     if (!orders.length) {
       showStatus("‡πÇ‡∏õ‡∏£‡∏î‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 1 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£", "danger");
       return;
     }
    
     showStatus("‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...", "info");
     sendOrderBtn.disabled = true;
    
     google.script.run
       .withSuccessHandler(() => {
         showStatus("‡∏™‡πà‡∏á‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à üéâ", "success");
         orders = [];
         renderOrders();
         loadTables(); // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÇ‡∏ï‡πä‡∏∞‡πÉ‡∏´‡∏°‡πà‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
         updateOrderButtons();
       })
       .withFailureHandler(err => {
         showStatus("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: " + err.message, "danger");
         sendOrderBtn.disabled = false;
       })
       .processOrder({
         timestamp: new Date().toISOString(),
         tableNumber: selectedTable,
         orders: orders
       });
   }


   // ‡∏•‡πâ‡∏≤‡∏á‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå
   function clearOrder() {
     if (orders.length && confirm("‡∏•‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î?")) {
       orders = [];
       renderOrders();
       showStatus("‡∏•‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢", "success");
       updateOrderButtons();
     }
   }


   // ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
   function updateCurrentTime() {
     const now = new Date();
     currentTimeEl.textContent = now.toLocaleString('th-TH', {
       weekday: 'long',
       year: 'numeric',
       month: 'long',
       day: 'numeric',
       hour: '2-digit',
       minute: '2-digit',
       second: '2-digit'
     });
   }


   // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö
   function initialize() {
     updateCurrentTime();
     setInterval(updateCurrentTime, 1000);
     loadTables();
     renderMenu();
     renderOrders();
     updateOrderButtons();
    
     // ‡∏≠‡∏µ‡πÄ‡∏ß‡∏ô‡∏ï‡πå‡∏•‡∏¥‡∏™‡πÄ‡∏ï‡∏ô‡πÄ‡∏ô‡∏≠‡∏£‡πå
     sendOrderBtn.addEventListener('click', sendOrder);
     clearOrderBtn.addEventListener('click', clearOrder);
    
     categoryBtns.forEach(btn => btn.addEventListener('click', () => {
       categoryBtns.forEach(b => b.classList.remove('active'));
       btn.classList.add('active');
       currentCategory = btn.dataset.category;
       renderMenu();
     }));
   }


   // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à
   window.addEventListener('DOMContentLoaded', initialize);
 </script>
</body>
</html>

